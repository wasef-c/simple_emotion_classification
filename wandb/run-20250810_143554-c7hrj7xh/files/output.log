üöÄ Starting experiment: Curr+Scaling
üìä Evaluation Mode: CROSS_CORPUS
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPI_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 7798 samples from MSPI
üìä MSPI Sessions:
   Session 1: 1108 samples
   Session 2: 1547 samples
   Session 3: 1431 samples
   Session 4: 1143 samples
   Session 5: 1518 samples
   Session 6: 518 samples
   Session 7: 533 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/IEMO_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 4490 samples from IEMO
üìä IEMO Sessions:
   Session None: 4490 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPP_Emotion2vec_filtered' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 80941 samples from MSPP
üìä MSPP Sessions:
   Session None: 80941 samples
üöÄ Training: MSPI -> [IEMO, MSPP]
üîß Using device: cuda
üìö Curriculum Learning: Enabled
üìä Cross-Corpus Only Mode: Train=80%, Val=20%
üìà Training samples: 6239
üìã Validation samples: 1559
üéØ Test datasets: IEMO, MSPP
üîç Using input_dim: 768 (detected from MSPI)
<config.Config object at 0x71ef57362dd0>
   Epoch 1: Using 1972/6239 samples (0.32)
   Epoch 1: Train Acc=0.4452, Val Acc=0.5561
   Epoch 2: Using 2790/6239 samples (0.45)
   Epoch 2: Train Acc=0.5341, Val Acc=0.5625
   Epoch 3: Using 3417/6239 samples (0.55)
   Epoch 3: Train Acc=0.5780, Val Acc=0.5978
   Epoch 4: Using 3945/6239 samples (0.63)
   Epoch 4: Train Acc=0.6309, Val Acc=0.6363
   Epoch 5: Using 4411/6239 samples (0.71)
   Epoch 5: Train Acc=0.6518, Val Acc=0.6588
   Epoch 6: Using 4832/6239 samples (0.77)
   Epoch 6: Train Acc=0.6683, Val Acc=0.6299
   Epoch 7: Using 5219/6239 samples (0.84)
   Epoch 7: Train Acc=0.6856, Val Acc=0.6690
   Epoch 8: Using 5580/6239 samples (0.89)
   Epoch 8: Train Acc=0.7052, Val Acc=0.6472
   Epoch 9: Using 5918/6239 samples (0.95)
   Epoch 9: Train Acc=0.7077, Val Acc=0.6652
   Epoch 10: Using 6239/6239 samples (1.00)
   Epoch 10: Train Acc=0.7150, Val Acc=0.6626
   Epoch 11: Curriculum complete, using all training data
   Epoch 11: Train Acc=0.7354, Val Acc=0.6690
   Epoch 12: Train Acc=0.7479, Val Acc=0.6562
   Epoch 13: Train Acc=0.7596, Val Acc=0.6774
   Epoch 14: Train Acc=0.7652, Val Acc=0.6453
   Epoch 15: Train Acc=0.7790, Val Acc=0.6870
   Epoch 16: Train Acc=0.7972, Val Acc=0.6774
   Epoch 17: Train Acc=0.7958, Val Acc=0.6600
   Epoch 18: Train Acc=0.8139, Val Acc=0.6863
   Epoch 19: Train Acc=0.8163, Val Acc=0.6709
   Epoch 20: Train Acc=0.8295, Val Acc=0.6915
   Epoch 21: Train Acc=0.8464, Val Acc=0.6851
   Epoch 22: Train Acc=0.8492, Val Acc=0.6851
   Epoch 23: Train Acc=0.8620, Val Acc=0.6722
   Epoch 24: Train Acc=0.8647, Val Acc=0.6889
   Epoch 25: Train Acc=0.8859, Val Acc=0.6876
   Epoch 26: Train Acc=0.8856, Val Acc=0.6940
   Epoch 27: Train Acc=0.8945, Val Acc=0.6780
   Epoch 28: Train Acc=0.9078, Val Acc=0.6761
   Epoch 29: Train Acc=0.9163, Val Acc=0.6844
   Epoch 30: Train Acc=0.9110, Val Acc=0.6831
‚ùå Experiment Curr+Scaling failed: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
üîç Full traceback:
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 171, in collate
    {
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 172, in <dictcomp>
    key: collate(
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 240, in collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 122, in run_all_experiments_from_yaml
    result = run_experiment(config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 210, in run_experiment
    results = run_cross_corpus_evaluation(config, train_dataset, test_datasets)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 676, in run_cross_corpus_evaluation
    test_result = evaluate_model(model, test_loader, criterion, device,
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/functions.py", line 42, in evaluate_model
    for batch in data_loader:
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 734, in __next__
    data = self._next_data()
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 790, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 191, in collate
    return {
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 192, in <dictcomp>
    key: collate([d[key] for d in batch], collate_fn_map=collate_fn_map)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 240, in collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>


============================================================
üß™ EXPERIMENT 2/3: No_Curriculum
============================================================
üß™ Running experiment: No_Curriculum
‚ö†Ô∏è  Unknown config parameter: class_weights
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
üöÄ Starting experiment: No_Curriculum
üìä Evaluation Mode: CROSS_CORPUS
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPI_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 755, in <module>
    main(args.config, experiment_id, args.all)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 731, in main
    return run_all_experiments_from_yaml(config_path)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 122, in run_all_experiments_from_yaml
    result = run_experiment(config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 170, in run_experiment
    train_dataset = SimpleEmotionDataset("MSPI", config=config, Train=True)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 322, in __init__
    for item in self.hf_dataset:
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 2466, in __iter__
    formatted_output = format_table(
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 657, in format_table
    return formatter(pa_table, query_type=query_type)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 410, in __call__
    return self.format_row(pa_table)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 458, in format_row
    row = self.python_arrow_extractor().extract_row(pa_table)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/datasets/formatting/formatting.py", line 143, in extract_row
    return _unnest(pa_table.to_pydict())
KeyboardInterrupt
