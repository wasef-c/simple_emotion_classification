üöÄ Starting experiment: exponential
üìä Evaluation Mode: CROSS_CORPUS
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPI_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 7798 samples from MSPI
üìä MSPI Sessions:
   Session 1: 1108 samples
   Session 2: 1547 samples
   Session 3: 1431 samples
   Session 4: 1143 samples
   Session 5: 1518 samples
   Session 6: 518 samples
   Session 7: 533 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/IEMO_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 4490 samples from IEMO
üìä IEMO Sessions:
   Session -1: 4490 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPP_Emotion2vec_filtered' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 80941 samples from MSPP
üìä MSPP Sessions:
   Session -1: 80941 samples
üöÄ Training: MSPI -> [IEMO, MSPP]
üîß Using device: cuda
üìö Curriculum Learning: Enabled
üìä Cross-Corpus Only Mode: Train=80%, Val=20%
üìà Training samples: 6239
üìã Validation samples: 1559
üéØ Test datasets: IEMO, MSPP
üîç Using input_dim: 768 (detected from MSPI)
<config.Config object at 0x74e60f65b730>
   Epoch 1: Using 6239/6239 samples (1.00)
   Epoch 1: Train Acc=0.5281, Val Acc=0.5786
   Epoch 2: Using 6239/6239 samples (1.00)
   Epoch 2: Train Acc=0.6262, Val Acc=0.6145
   Epoch 3: Using 6239/6239 samples (1.00)
   Epoch 3: Train Acc=0.6567, Val Acc=0.6459
   Epoch 4: Using 6239/6239 samples (1.00)
   Epoch 4: Train Acc=0.6705, Val Acc=0.6395
   Epoch 5: Using 6239/6239 samples (1.00)
   Epoch 5: Train Acc=0.6950, Val Acc=0.6543
   Epoch 6: Using 6239/6239 samples (1.00)
   Epoch 6: Train Acc=0.7120, Val Acc=0.6697
   Epoch 7: Using 6239/6239 samples (1.00)
   Epoch 7: Train Acc=0.7278, Val Acc=0.6466
   Epoch 8: Using 6239/6239 samples (1.00)
   Epoch 8: Train Acc=0.7384, Val Acc=0.6498
   Epoch 9: Using 6239/6239 samples (1.00)
   Epoch 9: Train Acc=0.7474, Val Acc=0.6748
   Epoch 10: Using 6239/6239 samples (1.00)
   Epoch 10: Train Acc=0.7572, Val Acc=0.6690
   Epoch 11: Curriculum complete, using all training data
   Epoch 11: Train Acc=0.7738, Val Acc=0.6709
   Epoch 12: Train Acc=0.7823, Val Acc=0.6684
   Epoch 13: Train Acc=0.8033, Val Acc=0.6754
   Epoch 14: Train Acc=0.8099, Val Acc=0.6754
   Epoch 15: Train Acc=0.8219, Val Acc=0.6761
   Epoch 16: Train Acc=0.8333, Val Acc=0.6786
   Epoch 17: Train Acc=0.8429, Val Acc=0.6844
   Epoch 18: Train Acc=0.8567, Val Acc=0.6825
   Epoch 19: Train Acc=0.8727, Val Acc=0.6870
   Epoch 20: Train Acc=0.8783, Val Acc=0.6838
   Epoch 21: Train Acc=0.8915, Val Acc=0.6857
   Epoch 22: Train Acc=0.8968, Val Acc=0.6857
   Epoch 23: Train Acc=0.9037, Val Acc=0.6831
   Epoch 24: Train Acc=0.9155, Val Acc=0.6857
   Epoch 25: Train Acc=0.9213, Val Acc=0.6838
   Epoch 26: Train Acc=0.9312, Val Acc=0.6786
   Epoch 27: Train Acc=0.9317, Val Acc=0.6908
   Epoch 28: Train Acc=0.9417, Val Acc=0.6818
   Epoch 29: Train Acc=0.9409, Val Acc=0.6844
   Epoch 30: Train Acc=0.9510, Val Acc=0.6870
‚ùå Experiment exponential failed: local variable 'correlation' referenced before assignment
üîç Full traceback:
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 126, in run_all_experiments_from_yaml
    result = run_experiment(config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 229, in run_experiment
    results = run_cross_corpus_evaluation(config, train_dataset, test_datasets)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 694, in run_cross_corpus_evaluation
    test_result = evaluate_model(model, test_loader, criterion, device,
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/functions.py", line 82, in evaluate_model
    difficulty_plot, difficulty_analysis = create_difficulty_accuracy_plot(
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/functions.py", line 241, in create_difficulty_accuracy_plot
    label=f'Best Fit (r={correlation:.3f})')
UnboundLocalError: local variable 'correlation' referenced before assignment


============================================================
üß™ EXPERIMENT 2/4: No_Curriculum
============================================================
üß™ Running experiment: No_Curriculum
‚ö†Ô∏è  Unknown config parameter: class_weights
üî¢ Random seed set to: 42
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
üöÄ Starting experiment: No_Curriculum
üìä Evaluation Mode: CROSS_CORPUS
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPI_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 7798 samples from MSPI
üìä MSPI Sessions:
   Session 1: 1108 samples
   Session 2: 1547 samples
   Session 3: 1431 samples
   Session 4: 1143 samples
   Session 5: 1518 samples
   Session 6: 518 samples
   Session 7: 533 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/IEMO_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
‚úÖ Loaded 4490 samples from IEMO
üìä IEMO Sessions:
   Session -1: 4490 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPP_Emotion2vec_filtered' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 773, in <module>
    main(args.config, experiment_id, args.all)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 749, in main
    return run_all_experiments_from_yaml(config_path)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 126, in run_all_experiments_from_yaml
    result = run_experiment(config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 194, in run_experiment
    SimpleEmotionDataset("MSPP", config=config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 342, in __init__
    features = torch.tensor(item["emotion2vec_features"][0]["feats"], dtype=torch.float32)
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x74e60f4b70a0>
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/wandb/sdk/lib/service/service_connection.py", line 54, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/wandb/sdk/lib/service/service_connection.py", line 182, in teardown
    self._router.join()
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/.venv/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt:
