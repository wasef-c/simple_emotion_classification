🚀 Starting experiment: square_root_2
📊 Evaluation Mode: CROSS_CORPUS
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPI_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
✅ Loaded 7798 samples from MSPI
📊 MSPI Sessions:
   Session 1: 1108 samples
   Session 2: 1547 samples
   Session 3: 1431 samples
   Session 4: 1143 samples
   Session 5: 1518 samples
   Session 6: 518 samples
   Session 7: 533 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/IEMO_Emotion2Vec' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
✅ Loaded 4490 samples from IEMO
📊 IEMO Sessions:
   Session -1: 4490 samples
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cairocode/MSPP_Emotion2vec_filtered' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
✅ Loaded 80941 samples from MSPP
📊 MSPP Sessions:
   Session -1: 80941 samples
🚀 Training: MSPI -> [IEMO, MSPP]
🔧 Using device: cuda
📚 Curriculum Learning: Enabled
📊 Cross-Corpus Only Mode: Train=80%, Val=20%
📈 Training samples: 6239
📋 Validation samples: 1559
🎯 Test datasets: IEMO, MSPP
🔍 Using input_dim: 768 (detected from MSPI)
<config.Config object at 0x707f5423ff40>
   Epoch 1: Using 1972/6239 samples (0.32)
❌ Experiment square_root_2 failed: local variable 'train_metrics' referenced before assignment
🔍 Full traceback:
Traceback (most recent call last):
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 126, in run_all_experiments_from_yaml
    result = run_experiment(config)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 229, in run_experiment
    results = run_cross_corpus_evaluation(config, train_dataset, test_datasets)
  File "/media/carol/Data/Documents/Emo_rec/Notebooks/emotion2vec_HAF/Version B/main.py", line 686, in run_cross_corpus_evaluation
    print(f"   Epoch {epoch+1}: Train Acc={train_metrics['accuracy']:.4f}, Val Acc={val_results['accuracy']:.4f}")
UnboundLocalError: local variable 'train_metrics' referenced before assignment


============================================================
📊 EXPERIMENT SUMMARY
============================================================
✅ Completed: 1
❌ Failed: 1
